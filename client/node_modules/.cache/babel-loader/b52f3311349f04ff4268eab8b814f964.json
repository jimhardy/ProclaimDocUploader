{"ast":null,"code":"var _jsxFileName = \"/Users/james/Sites/proclaim-doc-import/client/src/App.js\";\nimport React, { Component } from 'react';\nimport Notifications, { notify } from 'react-notify-toast';\nimport Spinner from './Spinner';\nimport Images from './Images';\nimport Buttons from './Buttons';\nimport { API_URL } from './config';\nimport './App.css';\nconst toastColor = {\n  background: '#505050',\n  text: '#fff'\n};\nexport default class App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      loading: true,\n      uploading: false,\n      images: []\n    };\n    this.toast = notify.createShowQueue();\n\n    this.onChange = e => {\n      const errs = [];\n      const files = Array.from(e.target.files);\n\n      if (files.length > 10) {\n        const msg = 'Only 10 images can be uploaded at a time';\n        return this.toast(msg, 'custom', 2000, toastColor);\n      }\n\n      const formData = new FormData();\n      const types = ['image/png', 'image/jpeg', 'image/gif'];\n      files.forEach((file, i) => {\n        if (types.every(type => file.type !== type)) {\n          errs.push(\"'\".concat(file.type, \"' is not a supported format\"));\n        } // if (file.size > 150000) {\n        //   errs.push(`'${file.name}' is too large, please pick a smaller file`);\n        // }\n\n\n        formData.append(i, file);\n      });\n\n      if (errs.length) {\n        return errs.forEach(err => this.toast(err, 'custom', 2000, toastColor));\n      }\n\n      this.setState({\n        uploading: true\n      });\n      fetch(\"\".concat(API_URL, \"/image-upload\"), {\n        method: 'POST',\n        body: formData\n      }).then(res => {\n        if (!res.ok) {\n          throw res;\n        }\n\n        return res.json();\n      }).then(images => {\n        this.setState({\n          uploading: false,\n          images\n        });\n      }).catch(err => {\n        err.json().then(e => {\n          this.toast(e.message, 'custom', 2000, toastColor);\n          this.setState({\n            uploading: false\n          });\n        });\n      });\n    };\n\n    this.filter = id => {\n      return this.state.images.filter(image => image.public_id !== id);\n    };\n\n    this.removeImage = id => {\n      this.setState({\n        images: this.filter(id)\n      });\n    };\n\n    this.onError = id => {\n      this.toast('Oops, something went wrong', 'custom', 2000, toastColor);\n      this.setState({\n        images: this.filter(id)\n      });\n    };\n  }\n\n  componentDidMount() {\n    fetch(\"\".concat(API_URL, \"/wake-up\")).then(res => {\n      if (res.ok) {\n        return this.setState({\n          loading: false\n        });\n      }\n\n      const msg = 'No response from server';\n      this.toast(msg, 'custom', 2000, toastColor);\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          loading = _this$state.loading,\n          uploading = _this$state.uploading,\n          images = _this$state.images;\n\n    const content = () => {\n      switch (true) {\n        case loading || uploading:\n          return React.createElement(Spinner, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 106\n            },\n            __self: this\n          });\n\n        case images.length > 0:\n          return React.createElement(Images, {\n            images: images,\n            removeImage: this.removeImage,\n            onError: this.onError,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 109\n            },\n            __self: this\n          });\n\n        default:\n          return React.createElement(Buttons, {\n            onChange: this.onChange,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 116\n            },\n            __self: this\n          });\n      }\n    };\n\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, React.createElement(Notifications, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"buttons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, content()));\n  }\n\n}","map":{"version":3,"sources":["/Users/james/Sites/proclaim-doc-import/client/src/App.js"],"names":["React","Component","Notifications","notify","Spinner","Images","Buttons","API_URL","toastColor","background","text","App","state","loading","uploading","images","toast","createShowQueue","onChange","e","errs","files","Array","from","target","length","msg","formData","FormData","types","forEach","file","i","every","type","push","append","err","setState","fetch","method","body","then","res","ok","json","catch","message","filter","id","image","public_id","removeImage","onError","componentDidMount","render","content"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Notifications, { notify } from 'react-notify-toast';\nimport Spinner from './Spinner';\nimport Images from './Images';\nimport Buttons from './Buttons';\nimport { API_URL } from './config';\nimport './App.css';\n\nconst toastColor = {\n  background: '#505050',\n  text: '#fff'\n};\n\nexport default class App extends Component {\n  state = {\n    loading: true,\n    uploading: false,\n    images: []\n  };\n\n  componentDidMount() {\n    fetch(`${API_URL}/wake-up`).then(res => {\n      if (res.ok) {\n        return this.setState({ loading: false });\n      }\n      const msg = 'No response from server';\n      this.toast(msg, 'custom', 2000, toastColor);\n    });\n  }\n\n  toast = notify.createShowQueue();\n\n  onChange = e => {\n    const errs = [];\n    const files = Array.from(e.target.files);\n\n    if (files.length > 10) {\n      const msg = 'Only 10 images can be uploaded at a time';\n      return this.toast(msg, 'custom', 2000, toastColor);\n    }\n\n    const formData = new FormData();\n    const types = ['image/png', 'image/jpeg', 'image/gif'];\n\n    files.forEach((file, i) => {\n      if (types.every(type => file.type !== type)) {\n        errs.push(`'${file.type}' is not a supported format`);\n      }\n\n      // if (file.size > 150000) {\n      //   errs.push(`'${file.name}' is too large, please pick a smaller file`);\n      // }\n\n      formData.append(i, file);\n    });\n\n    if (errs.length) {\n      return errs.forEach(err => this.toast(err, 'custom', 2000, toastColor));\n    }\n\n    this.setState({ uploading: true });\n\n    fetch(`${API_URL}/image-upload`, {\n      method: 'POST',\n      body: formData\n    })\n      .then(res => {\n        if (!res.ok) {\n          throw res;\n        }\n        return res.json();\n      })\n      .then(images => {\n        this.setState({\n          uploading: false,\n          images\n        });\n      })\n      .catch(err => {\n        err.json().then(e => {\n          this.toast(e.message, 'custom', 2000, toastColor);\n          this.setState({ uploading: false });\n        });\n      });\n  };\n\n  filter = id => {\n    return this.state.images.filter(image => image.public_id !== id);\n  };\n\n  removeImage = id => {\n    this.setState({ images: this.filter(id) });\n  };\n\n  onError = id => {\n    this.toast('Oops, something went wrong', 'custom', 2000, toastColor);\n    this.setState({ images: this.filter(id) });\n  };\n\n  render() {\n    const { loading, uploading, images } = this.state;\n\n    const content = () => {\n      switch (true) {\n        case loading || uploading:\n          return <Spinner />;\n        case images.length > 0:\n          return (\n            <Images\n              images={images}\n              removeImage={this.removeImage}\n              onError={this.onError}\n            />\n          );\n        default:\n          return <Buttons onChange={this.onChange} />;\n      }\n    };\n\n    return (\n      <div className=\"container\">\n        <Notifications />\n        <div className=\"buttons\">{content()}</div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}