{"ast":null,"code":"var _jsxFileName = \"/Users/james/Sites/proclaim-doc-import/client/src/App.js\";\nimport React, { Component } from 'react'; // import Notifications, { notify } from 'react-notify-toast';\n\nimport Spinner from './Spinner';\nimport Images from './Images';\nimport Buttons from './Buttons';\nimport { API_URL } from './config';\nimport './App.css';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nexport default class App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      loading: true,\n      uploading: false,\n      images: []\n    };\n    this.toast = notify.createShowQueue();\n\n    this.onChange = e => {\n      const errs = [];\n      const files = Array.from(e.target.files);\n\n      if (files.length > 10) {\n        const msg = 'Only 10 images can be uploaded at a time'; // return this.toast(msg, 'custom', 2000, toastColor);\n      }\n\n      const formData = new FormData();\n      const types = ['image/png', 'image/jpeg', 'image/gif'];\n      files.forEach((file, i) => {\n        if (types.every(type => file.type !== type)) {\n          errs.push(\"'\".concat(file.type, \"' is not a supported format\"));\n        }\n\n        if (file.size > 20000) {\n          toast('is too large, please pick a smaller file');\n        }\n\n        formData.append(i, file);\n      });\n\n      if (errs.length) {// return errs.forEach(err => this.toast(err, 'custom', 2000, toastColor));\n      }\n\n      this.setState({\n        uploading: true\n      });\n      fetch(\"\".concat(API_URL, \"/upload\"), {\n        method: 'POST',\n        body: formData\n      }).then(res => {\n        if (!res.ok) {\n          throw res;\n        }\n\n        return res.json();\n      }).then(images => {\n        this.setState({\n          uploading: false,\n          images\n        });\n      }).catch(err => {\n        err.json().then(e => {\n          // this.toast(e.message, 'custom', 2000, toastColor);\n          this.setState({\n            uploading: false\n          });\n        });\n      });\n    };\n\n    this.filter = id => {\n      return this.state.images.filter(image => image.public_id !== id);\n    };\n\n    this.removeImage = id => {\n      this.setState({\n        images: this.filter(id)\n      });\n    };\n\n    this.onError = id => {\n      this.setState({\n        images: this.filter(id)\n      });\n    };\n  }\n\n  componentDidMount() {\n    fetch(\"\".concat(API_URL, \"/wake-up\")).then(res => {\n      if (res.ok) {\n        return this.setState({\n          loading: false\n        });\n      }\n\n      const msg = 'No response from server'; // this.toast(msg, 'custom', 2000, toastColor);\n    });\n  }\n\n  render() {\n    const _this$state = this.state,\n          loading = _this$state.loading,\n          uploading = _this$state.uploading,\n          images = _this$state.images;\n\n    const content = () => {\n      switch (true) {\n        case loading || uploading:\n          return React.createElement(Spinner, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 102\n            },\n            __self: this\n          });\n\n        case images.length > 0:\n          return React.createElement(Images, {\n            images: images,\n            removeImage: this.removeImage,\n            onError: this.onError,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 105\n            },\n            __self: this\n          });\n\n        default:\n          return React.createElement(Buttons, {\n            onChange: this.onChange,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 112\n            },\n            __self: this\n          });\n      }\n    };\n\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(ToastContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"buttons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, content()));\n  }\n\n}","map":{"version":3,"sources":["/Users/james/Sites/proclaim-doc-import/client/src/App.js"],"names":["React","Component","Spinner","Images","Buttons","API_URL","ToastContainer","toast","App","state","loading","uploading","images","notify","createShowQueue","onChange","e","errs","files","Array","from","target","length","msg","formData","FormData","types","forEach","file","i","every","type","push","size","append","setState","fetch","method","body","then","res","ok","json","catch","err","filter","id","image","public_id","removeImage","onError","componentDidMount","render","content"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n// import Notifications, { notify } from 'react-notify-toast';\nimport Spinner from './Spinner';\nimport Images from './Images';\nimport Buttons from './Buttons';\nimport { API_URL } from './config';\nimport './App.css';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nexport default class App extends Component {\n  state = {\n    loading: true,\n    uploading: false,\n    images: []\n  };\n\n  componentDidMount() {\n    fetch(`${API_URL}/wake-up`).then(res => {\n      if (res.ok) {\n        return this.setState({ loading: false });\n      }\n      const msg = 'No response from server';\n      // this.toast(msg, 'custom', 2000, toastColor);\n    });\n  }\n\n  toast = notify.createShowQueue();\n\n  onChange = e => {\n    const errs = [];\n    const files = Array.from(e.target.files);\n\n    if (files.length > 10) {\n      const msg = 'Only 10 images can be uploaded at a time';\n      // return this.toast(msg, 'custom', 2000, toastColor);\n    }\n\n    const formData = new FormData();\n    const types = ['image/png', 'image/jpeg', 'image/gif'];\n\n    files.forEach((file, i) => {\n      if (types.every(type => file.type !== type)) {\n        errs.push(`'${file.type}' is not a supported format`);\n      }\n\n      if (file.size > 20000) {\n        toast('is too large, please pick a smaller file');\n      }\n\n      formData.append(i, file);\n    });\n\n    if (errs.length) {\n      // return errs.forEach(err => this.toast(err, 'custom', 2000, toastColor));\n    }\n\n    this.setState({ uploading: true });\n\n    fetch(`${API_URL}/upload`, {\n      method: 'POST',\n      body: formData\n    })\n      .then(res => {\n        if (!res.ok) {\n          throw res;\n        }\n        return res.json();\n      })\n      .then(images => {\n        this.setState({\n          uploading: false,\n          images\n        });\n      })\n      .catch(err => {\n        err.json().then(e => {\n          // this.toast(e.message, 'custom', 2000, toastColor);\n          this.setState({ uploading: false });\n        });\n      });\n  };\n\n  filter = id => {\n    return this.state.images.filter(image => image.public_id !== id);\n  };\n\n  removeImage = id => {\n    this.setState({ images: this.filter(id) });\n  };\n\n  onError = id => {\n    this.setState({ images: this.filter(id) });\n  };\n\n  render() {\n    const { loading, uploading, images } = this.state;\n\n    const content = () => {\n      switch (true) {\n        case loading || uploading:\n          return <Spinner />;\n        case images.length > 0:\n          return (\n            <Images\n              images={images}\n              removeImage={this.removeImage}\n              onError={this.onError}\n            />\n          );\n        default:\n          return <Buttons onChange={this.onChange} />;\n      }\n    };\n\n    return (\n      <div className=\"container\">\n        <ToastContainer />\n        <div className=\"buttons\">{content()}</div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}